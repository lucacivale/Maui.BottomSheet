<?xml version="1.0" encoding="utf-8" ?>

<bottomsheet:BottomSheet
    x:Class="TaskManager.BottomSheets.FilterBottomSheet"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:bottomsheet="http://pluginmauibottomsheet.com"
    xmlns:ios="clr-namespace:Microsoft.Maui.Controls.PlatformConfiguration.iOSSpecific;assembly=Microsoft.Maui.Controls"
    xmlns:models="clr-namespace:TaskManager.Models"
    xmlns:vm="clr-namespace:TaskManager.ViewModels"
    Padding="10,20,10,20"
    x:DataType="vm:FilterViewModel"
    ShowHeader="True"
    States="Peek,Medium,Large">
    <bottomsheet:BottomSheet.Header>
        <bottomsheet:BottomSheetHeader HeaderAppearance="LeftAndRightButton" TitleText="Filter tasks">
            <bottomsheet:BottomSheetHeader.TopLeftButton>
                <Button
                    Grid.Row="0"
                    BackgroundColor="#4CAF50"
                    Command="{Binding ApplyFilterCommand}"
                    CornerRadius="20"
                    FontAttributes="Bold"
                    Text="Apply"
                    TextColor="White" />
            </bottomsheet:BottomSheetHeader.TopLeftButton>
            <bottomsheet:BottomSheetHeader.TopRightButton>
                <Button
                    Grid.Column="2"
                    BackgroundColor="{AppThemeBinding Light=#E0E0E0,
                                                      Dark=#424242}"
                    Command="{Binding ClearFilterCommand}"
                    CornerRadius="20"
                    FontAttributes="Bold"
                    Text="Clear"
                    TextColor="{AppThemeBinding Light=#212121,
                                                Dark=#E0E0E0}" />
            </bottomsheet:BottomSheetHeader.TopRightButton>
        </bottomsheet:BottomSheetHeader>
    </bottomsheet:BottomSheet.Header>
    <bottomsheet:BottomSheet.Content>
        <bottomsheet:BottomSheetContent>
            <ScrollView Margin="0,10,0,0">
                <StackLayout Spacing="16">
                    <ContentView>
                        <ContentView.Behaviors>
                            <bottomsheet:BottomSheetPeekBehavior />
                        </ContentView.Behaviors>
                        <VerticalStackLayout Spacing="16">

                            <Border Padding="16" BackgroundColor="{AppThemeBinding Light=White, Dark=#2D2D2D}">
                                <StackLayout>
                                    <Label
                                        FontAttributes="Bold"
                                        FontSize="16"
                                        Text="Search Text"
                                        TextColor="{AppThemeBinding Light=#1976D2,
                                                                    Dark=#90CAF9}" />
                                    <SearchBar
                                        Margin="0,8,0,0"
                                        ios:SearchBar.SearchBarStyle="Minimal"
                                        Placeholder="Search in title and description"
                                        Text="{Binding SearchText}" />
                                </StackLayout>
                            </Border>

                            <Border Padding="16" BackgroundColor="{AppThemeBinding Light=White, Dark=#2D2D2D}">
                                <StackLayout>
                                    <Label
                                        FontAttributes="Bold"
                                        FontSize="16"
                                        Text="Status"
                                        TextColor="{AppThemeBinding Light=#1976D2,
                                                                    Dark=#90CAF9}" />
                                    <Picker
                                        Title="Select Status"
                                        Margin="0,8,0,0"
                                        FontSize="16"
                                        SelectedItem="{Binding SelectedStatus}">
                                        <Picker.ItemsSource>
                                            <x:Array Type="{x:Type models:TaskStatus}">
                                                <models:TaskStatus>Todo</models:TaskStatus>
                                                <models:TaskStatus>InProgress</models:TaskStatus>
                                                <models:TaskStatus>Completed</models:TaskStatus>
                                                <models:TaskStatus>Cancelled</models:TaskStatus>
                                            </x:Array>
                                        </Picker.ItemsSource>
                                    </Picker>
                                </StackLayout>
                            </Border>
                        </VerticalStackLayout>
                    </ContentView>

                    <Border Padding="16" BackgroundColor="{AppThemeBinding Light=White, Dark=#2D2D2D}">
                        <StackLayout>
                            <Label
                                FontAttributes="Bold"
                                FontSize="16"
                                Text="Priority"
                                TextColor="{AppThemeBinding Light=#1976D2,
                                                            Dark=#90CAF9}" />
                            <Picker
                                Title="Select Priority"
                                Margin="0,8,0,0"
                                FontSize="16"
                                SelectedItem="{Binding SelectedPriority}">
                                <Picker.ItemsSource>
                                    <x:Array Type="{x:Type models:TaskPriority}">
                                        <models:TaskPriority>Low</models:TaskPriority>
                                        <models:TaskPriority>Medium</models:TaskPriority>
                                        <models:TaskPriority>High</models:TaskPriority>
                                    </x:Array>
                                </Picker.ItemsSource>
                            </Picker>
                        </StackLayout>
                    </Border>

                    <Border Padding="16" BackgroundColor="{AppThemeBinding Light=White, Dark=#2D2D2D}">
                        <StackLayout>
                            <Label
                                FontAttributes="Bold"
                                FontSize="16"
                                Text="Category"
                                TextColor="{AppThemeBinding Light=#1976D2,
                                                            Dark=#90CAF9}" />
                            <Picker
                                Title="Select Category"
                                Margin="0,8,0,0"
                                FontSize="16"
                                ItemsSource="{Binding Categories}"
                                SelectedItem="{Binding SelectedCategory}" />
                        </StackLayout>
                    </Border>

                    <Border Padding="16" BackgroundColor="{AppThemeBinding Light=White, Dark=#2D2D2D}">
                        <StackLayout>
                            <Label
                                FontAttributes="Bold"
                                FontSize="16"
                                Text="Due Date Range"
                                TextColor="{AppThemeBinding Light=#1976D2,
                                                            Dark=#90CAF9}" />

                            <Grid Margin="0,8,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="16" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="16" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>

                                <Label
                                    Grid.Row="0"
                                    Grid.Column="0"
                                    FontSize="14"
                                    Text="From:"
                                    VerticalOptions="Center" />
                                <DatePicker
                                    Grid.Row="0"
                                    Grid.Column="2"
                                    Date="{Binding DueDateFrom}"
                                    FontSize="14" />

                                <Label
                                    Grid.Row="2"
                                    Grid.Column="0"
                                    FontSize="14"
                                    Text="To:"
                                    VerticalOptions="Center" />
                                <DatePicker
                                    Grid.Row="2"
                                    Grid.Column="2"
                                    Date="{Binding DueDateTo}"
                                    FontSize="14" />
                            </Grid>
                        </StackLayout>
                    </Border>
                </StackLayout>
            </ScrollView>
        </bottomsheet:BottomSheetContent>
    </bottomsheet:BottomSheet.Content>
</bottomsheet:BottomSheet>