<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="Plugin.BottomSheet.Tests.Maui.Ui.Application.Views.Pages.BottomSheetTests"
    x:DataType="viewModels:BottomSheetTestsViewModel"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:bottomsheet="clr-namespace:Plugin.BottomSheet;assembly=Plugin.BottomSheet"
    xmlns:converters="clr-namespace:Plugin.BottomSheet.Tests.Maui.Ui.Application.Converters"
    xmlns:mauibottomsheet="http://pluginmauibottomsheet.com"
    xmlns:mauibottomsheetandroid="http://pluginmauibottomsheet.com/platformconfiguration/android"
    xmlns:shared="clr-namespace:Plugin.BottomSheet.Tests.Maui.Ui.Application.Shared"
    xmlns:viewModels="clr-namespace:Plugin.BottomSheet.Tests.Maui.Ui.Application.ViewModels"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml">
    <ContentPage.Resources>
        <converters:BottomSheetStatesToBoolConverter x:Key="BottomSheetStatesToBoolConverter" />
        <converters:StringToThicknessConverter x:Key="StringToThicknessConverter" />
    </ContentPage.Resources>
    <ContentPage.Content>
        <VerticalStackLayout Padding="30,0" Spacing="25">
            <Button
                AutomationId="{x:Static shared:BottomSheetTestsAutomationIds.OpenBottomSheet}"
                Clicked="OpenBottomSheet"
                Text="Open BottomSheet" />
            <Button
                AutomationId="{x:Static shared:BottomSheetTestsAutomationIds.SomeButton}"
                Clicked="SomeButton_OnClicked"
                Text="Click me"
                x:Name="SomeButton" />
            <Button
                AutomationId="{x:Static shared:BottomSheetTestsAutomationIds.OpenStaticPeekBottomSheet}"
                Clicked="OpenStaticPeekBottomSheet_OnClicked"
                Text="Open Static Peek BottomSheet"
                x:Name="OpenStaticPeekBottomSheet" />
            <Button
                AutomationId="{x:Static shared:BottomSheetTestsAutomationIds.OpenDynamicPeekBottomSheet}"
                Clicked="OpenDynamicPeekBottomSheet_OnClicked"
                Text="Open Dynamic Peek BottomSheet"
                x:Name="OpenDynamicPeekBottomSheet" />
            <Button
                AutomationId="{x:Static shared:BottomSheetTestsAutomationIds.OpenDynamicAdvancedPeekBottomSheet}"
                Clicked="OpenDynamicAdvancedPeekBottomSheet_OnClicked"
                Text="Open Dynamic Peek BottomSheet Advanced"
                x:Name="OpenDynamicAdvancedPeekBottomSheet" />
            <Button
                AutomationId="{x:Static shared:BottomSheetTestsAutomationIds.OpenStaticPeekWithBuiltInHeaderBottomSheet}"
                Clicked="OpenStaticPeekWithBuiltInHeaderBottomSheet_OnClicked"
                Text="Open Static Peek With Built In Header BottomSheet"
                x:Name="OpenStaticPeekWithBuiltInHeaderBottomSheet" />
            <mauibottomsheet:BottomSheet
                AutomationId="{x:Static shared:BottomSheetTestsAutomationIds.BottomSheet}"
                BackgroundColor="{Binding BackgroundColor}"
                CornerRadius="{Binding CornerRadius}"
                CurrentState="{Binding CurrentState}"
                HasHandle="{Binding HasHandle}"
                IsCancelable="{Binding IsCancelable}"
                IsDraggable="{Binding IsDraggable}"
                IsModal="{Binding IsModal, Mode=TwoWay}"
                IsOpen="{Binding IsOpen}"
                Padding="{Binding Padding}"
                States="{Binding States}"
                WindowBackgroundColor="{Binding WindowBackgroundColor}"
                mauibottomsheetandroid:BottomSheet.HalfExpandedRatio="{Binding HalfExpandedRatio}"
                mauibottomsheetandroid:BottomSheet.Margin="{Binding Margin, Mode=OneWay, Converter={StaticResource StringToThicknessConverter}}"
                x:Name="BottomSheet">
                <mauibottomsheet:BottomSheet.Content>
                    <mauibottomsheet:BottomSheetContent>
                        <ScrollView>
                            <VerticalStackLayout AutomationId="{x:Static shared:BottomSheetTestsAutomationIds.Content}">
                                <Grid ColumnDefinitions="Auto, *" RowDefinitions="40">
                                    <Label Text="Test statess" VerticalOptions="Center" />
                                    <Switch
                                        AutomationId="{x:Static shared:BottomSheetTestsAutomationIds.TestStates}"
                                        Grid.Column="1"
                                        VerticalOptions="Center"
                                        x:Name="TestStates" />
                                </Grid>
                                <Grid
                                    ColumnDefinitions="Auto, *"
                                    RowDefinitions="40,40,40,40,40,40,40,40,50"
                                    RowSpacing="10">
                                    <Grid.Triggers>
                                        <DataTrigger
                                            Binding="{Binding IsToggled, Source={x:Reference TestStates}}"
                                            TargetType="Grid"
                                            Value="True">
                                            <Setter Property="IsVisible" Value="False" />
                                        </DataTrigger>
                                        <DataTrigger
                                            Binding="{Binding IsToggled, Source={x:Reference TestStates}}"
                                            TargetType="Grid"
                                            Value="False">
                                            <Setter Property="IsVisible" Value="True" />
                                        </DataTrigger>
                                    </Grid.Triggers>
                                    <Label Text="Corner radius" VerticalOptions="Center" />
                                    <Label
                                        Grid.Row="1"
                                        Text="Margin(Android only)"
                                        VerticalOptions="Center">
                                        <Label.FormattedText>
                                            <FormattedString>
                                                <Span Text="Margin " />
                                                <Span
                                                    FontAttributes="Italic"
                                                    FontSize="10"
                                                    Text="(Android only)" />
                                            </FormattedString>
                                        </Label.FormattedText>
                                    </Label>
                                    <Label
                                        Grid.Row="2"
                                        Text="Padding"
                                        VerticalOptions="Center" />
                                    <Label
                                        Grid.Row="3"
                                        Text="Half expanded ratio(Android only)"
                                        VerticalOptions="Center">
                                        <Label.FormattedText>
                                            <FormattedString>
                                                <Span Text="Half expanded ratio " />
                                                <Span
                                                    FontAttributes="Italic"
                                                    FontSize="10"
                                                    Text="(Android only)" />
                                            </FormattedString>
                                        </Label.FormattedText>
                                    </Label>
                                    <Label
                                        Grid.Row="4"
                                        Text="Is modal?"
                                        VerticalOptions="Center" />
                                    <Label
                                        Grid.Row="5"
                                        Text="Has handle?"
                                        VerticalOptions="Center" />
                                    <Label
                                        Grid.Row="6"
                                        Text="Is cancelable?"
                                        VerticalOptions="Center" />
                                    <Label
                                        Grid.Row="7"
                                        Text="Is draggable?"
                                        VerticalOptions="Center" />
                                    <Entry
                                        AutomationId="{x:Static shared:BottomSheetTestsAutomationIds.CornerRadius}"
                                        Grid.Column="1"
                                        Keyboard="Numeric"
                                        Text="{Binding CornerRadius}"
                                        VerticalOptions="Center" />
                                    <Entry
                                        AutomationId="{x:Static shared:BottomSheetTestsAutomationIds.Margin}"
                                        Grid.Column="1"
                                        Grid.Row="1"
                                        Text="{Binding Margin}"
                                        VerticalOptions="Center" />
                                    <Entry
                                        AutomationId="{x:Static shared:BottomSheetTestsAutomationIds.Padding}"
                                        Grid.Column="1"
                                        Grid.Row="2"
                                        Text="{Binding Padding}"
                                        VerticalOptions="Center" />
                                    <Entry
                                        AutomationId="{x:Static shared:BottomSheetTestsAutomationIds.HalfExpandedRatio}"
                                        Grid.Column="1"
                                        Grid.Row="3"
                                        HorizontalTextAlignment="End"
                                        Keyboard="Numeric"
                                        Text="{Binding HalfExpandedRatio}"
                                        VerticalOptions="Center" />
                                    <Switch
                                        AutomationId="{x:Static shared:BottomSheetTestsAutomationIds.IsModal}"
                                        Grid.Column="1"
                                        Grid.Row="4"
                                        IsToggled="{Binding IsModal}"
                                        VerticalOptions="Center" />
                                    <Switch
                                        AutomationId="{x:Static shared:BottomSheetTestsAutomationIds.HasHandle}"
                                        Grid.Column="1"
                                        Grid.Row="5"
                                        IsToggled="{Binding HasHandle}"
                                        VerticalOptions="Center" />
                                    <Switch
                                        AutomationId="{x:Static shared:BottomSheetTestsAutomationIds.IsCancelable}"
                                        Grid.Column="1"
                                        Grid.Row="6"
                                        IsToggled="{Binding IsCancelable}"
                                        VerticalOptions="Center" />
                                    <Switch
                                        AutomationId="{x:Static shared:BottomSheetTestsAutomationIds.IsDraggable}"
                                        Grid.Column="1"
                                        Grid.Row="7"
                                        IsToggled="{Binding IsDraggable}"
                                        VerticalOptions="Center" />
                                    <Grid
                                        ColumnDefinitions="*,*"
                                        ColumnSpacing="10"
                                        Grid.ColumnSpan="2"
                                        Grid.Row="8">
                                        <Button
                                            AutomationId="{x:Static shared:BottomSheetTestsAutomationIds.ChangeWindowBackgroundColor}"
                                            Command="{Binding ChangeWindowBackgroundColorCommand}"
                                            FontSize="10"
                                            HorizontalOptions="Center"
                                            Text="Change window background color" />
                                        <Button
                                            AutomationId="{x:Static shared:BottomSheetTestsAutomationIds.ChangeBackgroundColor}"
                                            Command="{Binding ChangeBackgroundColorCommand}"
                                            FontSize="10"
                                            Grid.Column="1"
                                            HorizontalOptions="Center"
                                            Text="Change background color" />
                                    </Grid>
                                </Grid>
                                <Grid ColumnDefinitions="*,*" RowDefinitions="25,25">
                                    <Label
                                        FontAttributes="Bold"
                                        FontSize="20"
                                        Grid.ColumnSpan="2"
                                        Text="States" />
                                    <Label
                                        Grid.Row="1"
                                        Margin="35,0,0,0"
                                        Text="Medium"
                                        VerticalOptions="Center" />
                                    <Label
                                        Grid.Column="1"
                                        Grid.Row="1"
                                        Margin="35,0,0,0"
                                        Text="Large"
                                        VerticalOptions="Center" />
                                    <CheckBox
                                        AutomationId="{x:Static shared:BottomSheetTestsAutomationIds.MediumState}"
                                        CheckedChanged="Medium_OnCheckedChanged"
                                        Grid.Row="1"
                                        HorizontalOptions="Start"
                                        IsChecked="{Binding States, Mode=OneWay, Converter={x:StaticResource BottomSheetStatesToBoolConverter}, ConverterParameter={x:Static bottomsheet:BottomSheetState.Medium}}"
                                        VerticalOptions="Center"
                                        x:Name="Medium" />
                                    <CheckBox
                                        AutomationId="{x:Static shared:BottomSheetTestsAutomationIds.LargeState}"
                                        CheckedChanged="Large_OnCheckedChanged"
                                        Grid.Column="1"
                                        Grid.Row="1"
                                        HorizontalOptions="Start"
                                        IsChecked="{Binding States, Mode=OneWay, Converter={x:StaticResource BottomSheetStatesToBoolConverter}, ConverterParameter={x:Static bottomsheet:BottomSheetState.Large}}"
                                        VerticalOptions="Center"
                                        x:Name="Large" />
                                </Grid>
                                <Grid
                                    ColumnDefinitions="*,*"
                                    RowDefinitions="30,30"
                                    x:Name="CurrentState">
                                    <Label
                                        FontAttributes="Bold"
                                        FontSize="20"
                                        Grid.ColumnSpan="2"
                                        Text="Current state"
                                        VerticalTextAlignment="Center" />
                                    <Label
                                        Grid.Row="1"
                                        Text="Medium"
                                        VerticalTextAlignment="Center" />
                                    <CheckBox
                                        AutomationId="{x:Static shared:BottomSheetTestsAutomationIds.CurrentMediumState}"
                                        CheckedChanged="MediumCheckBox_OnCheckedChanged"
                                        Grid.Row="1"
                                        x:Name="MediumCheckBox" />
                                    <Label
                                        Grid.Column="1"
                                        Grid.Row="1"
                                        Text="Large"
                                        VerticalTextAlignment="Center" />
                                    <CheckBox
                                        AutomationId="{x:Static shared:BottomSheetTestsAutomationIds.CurrentLargeState}"
                                        CheckedChanged="LargeCheckBox_OnCheckedChanged"
                                        Grid.Column="1"
                                        Grid.Row="1"
                                        x:Name="LargeCheckBox" />
                                </Grid>
                            </VerticalStackLayout>
                        </ScrollView>
                    </mauibottomsheet:BottomSheetContent>
                </mauibottomsheet:BottomSheet.Content>
            </mauibottomsheet:BottomSheet>
            <mauibottomsheet:BottomSheet
                AutomationId="{x:Static shared:BottomSheetTestsAutomationIds.StaticPeekBottomSheet}"
                PeekHeight="{mauibottomsheet:PeekView View={x:Reference ContentBox}}"
                States="Peek"
                x:Name="PeekBottomSheetStaticHeight">
                <mauibottomsheet:BottomSheet.Content>
                    <mauibottomsheet:BottomSheetContent>
                        <mauibottomsheet:BottomSheetContent.Content>
                            <Grid AutomationId="{x:Static shared:BottomSheetTestsAutomationIds.Content}" RowDefinitions="300">
                                <BoxView Color="Orange" x:Name="ContentBox" />
                            </Grid>
                        </mauibottomsheet:BottomSheetContent.Content>
                    </mauibottomsheet:BottomSheetContent>
                </mauibottomsheet:BottomSheet.Content>
            </mauibottomsheet:BottomSheet>
            <mauibottomsheet:BottomSheet
                AutomationId="{x:Static shared:BottomSheetTestsAutomationIds.StaticPeekWithBuiltInHeaderBottomSheet}"
                PeekHeight="{mauibottomsheet:PeekView View={x:Reference Content2}}"
                States="Peek"
                x:Name="PeekBottomSheetStaticHeightWithBuiltInHeader">
                <mauibottomsheet:BottomSheet.Header>
                    <mauibottomsheet:BottomSheetHeader ShowCloseButton="True" TitleText="Hallo" />
                </mauibottomsheet:BottomSheet.Header>
                <mauibottomsheet:BottomSheet.Triggers>
                    <DataTrigger
                        Binding="{Binding IsToggled, Source={x:Reference ShowBuiltInHeader}}"
                        TargetType="mauibottomsheet:BottomSheet"
                        Value="True">
                        <Setter Property="ShowHeader" Value="True" />
                    </DataTrigger>
                    <DataTrigger
                        Binding="{Binding IsToggled, Source={x:Reference ShowBuiltInHeader}}"
                        TargetType="mauibottomsheet:BottomSheet"
                        Value="False">
                        <Setter Property="ShowHeader" Value="False" />
                    </DataTrigger>
                </mauibottomsheet:BottomSheet.Triggers>
                <mauibottomsheet:BottomSheet.Content>
                    <mauibottomsheet:BottomSheetContent>
                        <mauibottomsheet:BottomSheetContent.Content>
                            <VerticalStackLayout x:Name="Content2">
                                <Grid RowDefinitions="300">
                                    <BoxView Color="LightGrey" />
                                </Grid>
                                <Grid ColumnDefinitions="Auto,*">
                                    <Label Text="Show header:" VerticalOptions="Center" />
                                    <Switch
                                        Grid.Column="1"
                                        HorizontalOptions="Start"
                                        VerticalOptions="Center"
                                        x:Name="ShowBuiltInHeader" />
                                </Grid>
                            </VerticalStackLayout>
                        </mauibottomsheet:BottomSheetContent.Content>
                    </mauibottomsheet:BottomSheetContent>
                </mauibottomsheet:BottomSheet.Content>
            </mauibottomsheet:BottomSheet>
            <mauibottomsheet:BottomSheet
                AutomationId="{x:Static shared:BottomSheetTestsAutomationIds.DynamicPeekBottomSheet}"
                PeekHeight="{mauibottomsheet:PeekView StackLayout}"
                States="Peek"
                x:Name="PeekBottomSheetDynamic">
                <mauibottomsheet:BottomSheet.Content>
                    <mauibottomsheet:BottomSheetContent>
                        <mauibottomsheet:BottomSheetContent.Content>
                            <VerticalStackLayout x:Name="StackLayout">
                                <Label FontSize="40" Text="{Binding Text, Source={Reference Entry}}" />
                                <Entry FontSize="40" x:Name="Entry" />
                            </VerticalStackLayout>
                        </mauibottomsheet:BottomSheetContent.Content>
                    </mauibottomsheet:BottomSheetContent>
                </mauibottomsheet:BottomSheet.Content>
            </mauibottomsheet:BottomSheet>
            <mauibottomsheet:BottomSheet
                AutomationId="{x:Static shared:BottomSheetTestsAutomationIds.DynamicAdvancedPeekBottomSheet}"
                PeekHeight="{mauibottomsheet:PeekView View={Reference AdvancedPeek}}"
                States="Peek"
                x:Name="PeekBottomSheetDynamicAdvanced">
                <mauibottomsheet:BottomSheet.Content>
                    <mauibottomsheet:BottomSheetContent>
                        <mauibottomsheet:BottomSheetContent.Content>
                            <Grid RowDefinitions="*,auto" x:Name="AdvancedPeek">
                                <ScrollView Padding="16,24,16,0">
                                    <VerticalStackLayout Spacing="16">
                                        <Label FontAttributes="Bold" Text="Name Change" />
                                        <Entry ReturnType="Done" />
                                    </VerticalStackLayout>
                                </ScrollView>
                                <VerticalStackLayout Grid.Row="1" Spacing="8">
                                    <Button Text="Save" />
                                    <Button
                                        BackgroundColor="Transparent"
                                        BorderColor="{StaticResource Magenta}"
                                        BorderWidth="1"
                                        Text="Cancel"
                                        TextColor="Black" />
                                </VerticalStackLayout>
                            </Grid>
                        </mauibottomsheet:BottomSheetContent.Content>
                    </mauibottomsheet:BottomSheetContent>
                </mauibottomsheet:BottomSheet.Content>
            </mauibottomsheet:BottomSheet>
        </VerticalStackLayout>
    </ContentPage.Content>
</ContentPage>